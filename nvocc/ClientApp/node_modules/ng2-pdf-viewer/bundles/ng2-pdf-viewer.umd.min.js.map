{"version":3,"sources":["../../src/app/pdf-viewer/pdf-viewer.component.ts","../../src/app/utils/event-bus-utils.ts","../../src/app/utils/helpers.ts","../../src/app/pdf-viewer/pdf-viewer.module.ts"],"names":["RenderTextMode","createEventBus","pdfJsViewer","destroy$","globalEventBus","EventBus","eventBus","fromEvent","pipe","takeUntil","subscribe","event","document","createEvent","initCustomEvent","window","dispatchEvent","_a","pageNumber","cssTransform","source","div","textLayerDiv","initEvent","container","pagesCount","scale","presetValue","location","type","query","phraseSearch","caseSensitive","highlightAll","findPrevious","attachmentsCount","view","outerContainer","mode","pdfViewer","action","active","switchInProgress","outlineCount","attachDOMEventsToEventBus","assign","obj","prop","value","isSSR","PDFJS","VerbosityLevel","ERRORS","PdfViewerComponent","element","pdfWorkerSrc","this","isVisible","_cMapsUrl","version","_renderText","_renderTextMode","ENABLED","_stickToPage","_originalSize","_page","_zoom","_zoomScale","_rotation","_showAll","_canAutoResize","_fitToPage","_externalLinkTarget","_showBorders","resizeTimeout","pageScrollTimeout","isInitialized","Subject","afterLoadComplete","EventEmitter","pageRendered","pageInitialized","textLayerRendered","onError","onProgress","pageChange","hasOwnProperty","GlobalWorkerOptions","Object","defineProperty","prototype","cMapsUrl","originalPage","parseInt","_pdf","getValidPageNumber","emit","renderText","renderTextMode","originalSize","console","warn","Boolean","getLinkTarget","LinkTarget","BLANK","NONE","SELF","PARENT","TOP","ngAfterViewChecked","_this","offset","pdfViewerContainer","nativeElement","offsetParent","setTimeout","ngOnInit","ngOnChanges","src","setupMultiPageViewer","setupSinglePageViewer","ngOnDestroy","clear","next","loadingTask","onPageResize","clearTimeout","updateSize","pdfMultiPageLinkService","pdfSinglePageLinkService","getCurrentViewer","pdfMultiPageFindController","pdfSinglePageFindController","changes","loadPDF","textLayerMode","DISABLED","resetPdfDocument","page","currentValue","_latestScrolledPage","scrollPageIntoView","update","currentViewer","from","getPage","currentPageNumber","rotation","rotate","viewportWidth","getViewport","width","CSS_UNITS","stickToPage","clientWidth","viewPort","getScale","height","_setScale","destroyed","destroy","pdfMultiPageViewer","setDocument","pdfSinglePageViewer","getPDFLinkServiceConfig","pdfLinkServiceConfig","linkTarget","externalLinkTarget","PDFJSViewer","PDFLinkService","PDFFindController","linkService","pdfOptions","querySelector","removePageBorders","findController","PDFViewer","setViewer","PDFSinglePageViewer","_currentPageNumber","numPages","getDocumentParams","srcType","params","cMapUrl","cMapPacked","url","undefined","byteLength","data","lastLoaded","getDocument","progressData","promise","pdf","error","render","pagesRotation","viewportHeight","borderSize","BORDER_WIDTH","pdfContainerWidth","pdfContainerHeight","clientHeight","ratio","Math","min","pdfFindController","Component","args","selector","template","ElementRef","ViewChild","Output","Input","HostListener","NgModule","declarations","exports"],"mappings":"8zBAqCYA,yBC7BIC,EAAeC,EAAkBC,GAC/C,IAAMC,EAA2B,IAAIF,EAAYG,SAEjD,OAGF,SACEC,EACAH,GAEAI,EAAAA,UAAUD,EAAU,gBACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,WACT,IAAMC,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,gBAAgB,GAAM,EAAM,IAClDC,OAAOC,cAAcL,MAGzBJ,EAAAA,UAAUD,EAAU,gBACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEC,EAAUD,EAAAC,WAAEC,EAAYF,EAAAE,aAAEC,EAAMH,EAAAG,OACtCT,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,gBAAgB,GAAM,EAAM,CAChDI,WAAUA,EACVC,aAAYA,IAEdC,EAAOC,IAAIL,cAAcL,MAG7BJ,EAAAA,UAAUD,EAAU,qBACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEC,EAAUD,EAAAC,WAAEE,EAAMH,EAAAG,OACxBT,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,qBAAqB,GAAM,EAAM,CAAEI,WAAUA,IACnEE,EAAOE,aAAaN,cAAcL,MAGtCJ,EAAAA,UAAUD,EAAU,gBACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEC,EAAUD,EAAAC,WAAEE,EAAMH,EAAAG,OACxBT,EAAQC,SAASC,YAAY,YACnCF,EAAMY,UAAU,gBAAgB,GAAM,GAEtCZ,EAAkB,WAAIO,EACtBE,EAAOI,UAAUR,cAAcL,MAGnCJ,EAAAA,UAAUD,EAAU,aACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEG,EAAMH,EAAAG,OACZT,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,aAAa,GAAM,EAAM,MAC/CM,EAAOI,UAAUR,cAAcL,MAGnCJ,EAAAA,UAAUD,EAAU,eACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEQ,EAAUR,EAAAQ,WAAEL,EAAMH,EAAAG,OACxBT,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,eAAe,GAAM,EAAM,CAAEW,WAAUA,IAC7DL,EAAOI,UAAUR,cAAcL,MAGnCJ,EAAAA,UAAUD,EAAU,eACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAES,EAAKT,EAAAS,MAAEC,EAAWV,EAAAU,YAAEP,EAAMH,EAAAG,OAChCT,EAAQC,SAASC,YAAY,YACnCF,EAAMY,UAAU,eAAe,GAAM,GAErCZ,EAAa,MAAIe,EAEjBf,EAAmB,YAAIgB,EACvBP,EAAOI,UAAUR,cAAcL,MAGnCJ,EAAAA,UAAUD,EAAU,kBACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEW,EAAQX,EAAAW,SAAER,EAAMH,EAAAG,OACtBT,EAAQC,SAASC,YAAY,YACnCF,EAAMY,UAAU,kBAAkB,GAAM,GACxCZ,EAAgB,SAAIiB,EACpBR,EAAOI,UAAUR,cAAcL,MAGnCJ,EAAAA,UAAUD,EAAU,QACjBE,KAAKC,EAAAA,UAAUN,IACfO,WACC,SAACO,OACCG,EAAMH,EAAAG,OACNS,EAAIZ,EAAAY,KACJC,EAAKb,EAAAa,MACLC,EAAYd,EAAAc,aACZC,EAAaf,EAAAe,cACbC,EAAYhB,EAAAgB,aACZC,EAAYjB,EAAAiB,aAEZ,GAAId,IAAWL,OAAf,CAGA,IAAMJ,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,OAASe,GAAM,GAAM,EAAM,CAC/CC,MAAKA,EACLC,aAAYA,EACZC,cAAaA,EACbC,aAAYA,EACZC,aAAYA,IAEdnB,OAAOC,cAAcL,OAI3BJ,EAAAA,UAAUD,EAAU,qBACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEkB,EAAgBlB,EAAAkB,iBAAEf,EAAMH,EAAAG,OAC9BT,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,qBAAqB,GAAM,EAAM,CACrDqB,iBAAgBA,IAElBf,EAAOI,UAAUR,cAAcL,MAGnCJ,EAAAA,UAAUD,EAAU,sBACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEmB,EAAInB,EAAAmB,KAAEhB,EAAMH,EAAAG,OAClBT,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,sBAAsB,GAAM,EAAM,CAAEsB,KAAIA,IAC9DhB,EAAOiB,eAAerB,cAAcL,MAGxCJ,EAAAA,UAAUD,EAAU,YACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEqB,EAAIrB,EAAAqB,KAAElB,EAAMH,EAAAG,OAClBT,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,YAAY,GAAM,EAAM,CAAEwB,KAAIA,IACpDlB,EAAOmB,UAAUf,UAAUR,cAAcL,MAG7CJ,EAAAA,UAAUD,EAAU,eACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEuB,EAAMvB,EAAAuB,OAAEpB,EAAMH,EAAAG,OACpBT,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,eAAe,GAAM,EAAM,CAAE0B,OAAMA,IACzDpB,EAAOmB,UAAUf,UAAUR,cAAcL,MAG7CJ,EAAAA,UAAUD,EAAU,2BACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAEwB,EAAMxB,EAAAwB,OAAEC,EAAgBzB,EAAAyB,iBAC9B/B,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,2BAA2B,GAAM,EAAM,CAC3D2B,OAAMA,EACNC,iBAAgBA,IAElB3B,OAAOC,cAAcL,MAGzBJ,EAAAA,UAAUD,EAAU,iBACjBE,KAAKC,EAAAA,UAAUN,IACfO,WAAU,SAACO,OAAE0B,EAAY1B,EAAA0B,aAAEvB,EAAMH,EAAAG,OAC1BT,EAAQC,SAASC,YAAY,eACnCF,EAAMG,gBAAgB,iBAAiB,GAAM,EAAM,CAAE6B,aAAYA,IACjEvB,EAAOI,UAAUR,cAAcL,MA/JnCiC,CAA0BxC,EAAgBD,GACnCC,WCXOyC,EAAOC,EAAaC,EAAcC,GAChDF,EAAIC,GAAQC,WAGEC,IACd,MAAyB,oBAAXlC,OF4BXkC,KACHJ,EAAOK,EAAO,YAAaA,EAAMC,eAAeC,QAGtCpD,EAAAA,oBAAAA,GAAAA,EAAAA,EAAAA,iBAAAA,EAAAA,eAAc,KACxBA,EAAA,SAAA,GAAA,WACAA,EAAAA,EAAA,QAAA,GAAA,UACAA,EAAAA,EAAA,SAAA,GAAA,4BAkLA,SAAAqD,EAAoBC,GAKlB,IAAIC,GALcC,KAAAF,QAAAA,EA/JZE,KAAAC,WAAY,EASZD,KAAAE,eACW,IAAVR,EACH,gCAAiCA,EAAcS,QAAO,UACtD,KACEH,KAAAI,aAAc,EACdJ,KAAAK,gBAAkC7D,EAAAA,eAAe8D,QACjDN,KAAAO,cAAe,EACfP,KAAAQ,eAAgB,EAEhBR,KAAAS,MAAQ,EACRT,KAAAU,MAAQ,EACRV,KAAAW,WAAwD,aACxDX,KAAAY,UAAY,EACZZ,KAAAa,UAAW,EACXb,KAAAc,gBAAiB,EACjBd,KAAAe,YAAa,EACbf,KAAAgB,oBAAsB,QACtBhB,KAAAiB,cAAe,EAIfjB,KAAAkB,cAA+B,KAC/BlB,KAAAmB,kBAAmC,KACnCnB,KAAAoB,eAAgB,EAEhBpB,KAAArD,SAAW,IAAI0E,EAAAA,QAEQrB,KAAAsB,kBAAoB,IAAIC,EAAAA,aAC9BvB,KAAAwB,aAAe,IAAID,EAAAA,aACfvB,KAAAyB,gBAAkB,IAAIF,EAAAA,aACpBvB,KAAA0B,kBAAoB,IAAIH,EAAAA,aACtCvB,KAAA2B,QAAU,IAAIJ,EAAAA,aACRvB,KAAA4B,WAAa,IAAIL,EAAAA,aAC9BvB,KAAA6B,WAAmC,IAAIN,EAAAA,cAAqB,GAsHhE9B,OAWFM,EAJAxC,OAAOuE,eAAe,iBACkB,iBAAhCvE,OAAewC,cACtBxC,OAAewC,aAEAxC,OAAewC,aAEhB,2CAA4CL,EAAcS,QACvE,2BAGJd,EAAOK,EAAMqC,oBAAqB,YAAahC,WApIjDiC,OAAAC,eACIpC,EAAAqC,UAAA,WAAQ,KADZ,SACaC,GACXnC,KAAKE,UAAYiC,mCAGnBH,OAAAC,eACIpC,EAAAqC,UAAA,OAAI,KADR,SACSzB,GAEP,IAAM2B,EADN3B,EAAQ4B,SAAS5B,EAAO,KAAO,EAG3BT,KAAKsC,OACP7B,EAAQT,KAAKuC,mBAAmB9B,IAGlCT,KAAKS,MAAQA,EACT2B,IAAiB3B,GACnBT,KAAK6B,WAAWW,KAAK/B,oCAIzBuB,OAAAC,eACIpC,EAAAqC,UAAA,aAAU,KADd,SACeO,GACbzC,KAAKI,YAAcqC,mCAGrBT,OAAAC,eACIpC,EAAAqC,UAAA,iBAAc,KADlB,SACmBQ,GACjB1C,KAAKK,gBAAkBqC,mCAGzBV,OAAAC,eACIpC,EAAAqC,UAAA,eAAY,KADhB,SACiBS,GACf3C,KAAKQ,cAAgBmC,mCAGvBX,OAAAC,eACIpC,EAAAqC,UAAA,UAAO,KADX,SACY1C,GACVQ,KAAKa,SAAWrB,mCAGlBwC,OAAAC,eACIpC,EAAAqC,UAAA,cAAW,KADf,SACgB1C,GACdQ,KAAKO,aAAef,mCAGtBwC,OAAAC,eACIpC,EAAAqC,UAAA,OAAI,KAQR,WACE,OAAOlC,KAAKU,WAVd,SACSlB,GACHA,GAAS,IAIbQ,KAAKU,MAAQlB,oCAOfwC,OAAAC,eACIpC,EAAAqC,UAAA,YAAS,KAIb,WACE,OAAOlC,KAAKW,gBANd,SACcnB,GACZQ,KAAKW,WAAanB,mCAOpBwC,OAAAC,eACIpC,EAAAqC,UAAA,WAAQ,KADZ,SACa1C,GACY,iBAAVA,GAAsBA,EAAQ,IAAO,EAKlDQ,KAAKY,UAAYpB,EAJfoD,QAAQC,KAAK,kEAOjBb,OAAAC,eACIpC,EAAAqC,UAAA,qBAAkB,KADtB,SACuB1C,GACrBQ,KAAKgB,oBAAsBxB,mCAG7BwC,OAAAC,eACIpC,EAAAqC,UAAA,aAAU,KADd,SACe1C,GACbQ,KAAKc,eAAiBgC,QAAQtD,oCAGhCwC,OAAAC,eACIpC,EAAAqC,UAAA,YAAS,KADb,SACc1C,GACZQ,KAAKe,WAAa+B,QAAQtD,oCAG5BwC,OAAAC,eACIpC,EAAAqC,UAAA,cAAW,KADf,SACgB1C,GACdQ,KAAKiB,aAAe6B,QAAQtD,oCAGvBK,EAAAkD,cAAP,SAAqB1E,GACnB,OAAQA,GACN,IAAK,QACH,OAAQqB,EAAcsD,WAAWC,MACnC,IAAK,OACH,OAAQvD,EAAcsD,WAAWE,KACnC,IAAK,OACH,OAAQxD,EAAcsD,WAAWG,KACnC,IAAK,SACH,OAAQzD,EAAcsD,WAAWI,OACnC,IAAK,MACH,OAAQ1D,EAAcsD,WAAWK,IAGrC,OAAO,MAwBTxD,EAAAqC,UAAAoB,mBAAA,WAAA,IAAAC,EAAAvD,KACE,IAAIA,KAAKoB,cAAT,CAIA,IAAMoC,EAASxD,KAAKyD,mBAAmBC,cAAcC,cAE9B,IAAnB3D,KAAKC,WAAgC,MAAVuD,GAKR,IAAnBxD,KAAKC,WAAiC,MAAVuD,IAC9BxD,KAAKC,WAAY,EAEjB2D,YAAW,WACTL,EAAKM,WACLN,EAAKO,YAAY,CAAEC,IAAKR,EAAKQ,UAT/B/D,KAAKC,WAAY,IAcrBJ,EAAAqC,UAAA2B,SAAA,YACOpE,KAAWO,KAAKC,YACnBD,KAAKoB,eAAgB,EACrBpB,KAAKgE,uBACLhE,KAAKiE,0BAITpE,EAAAqC,UAAAgC,YAAA,WACElE,KAAKmE,QACLnE,KAAKrD,SAASyH,OACdpE,KAAKqE,YAAc,MAIdxE,EAAAqC,UAAAoC,aAAA,WAAA,IAAAf,EAAAvD,KACAA,KAAKc,gBAAmBd,KAAKsC,OAI9BtC,KAAKkB,eACPqD,aAAavE,KAAKkB,eAGpBlB,KAAKkB,cAAgB3D,OAAOqG,YAAW,WACrCL,EAAKiB,eACJ,OAGLxC,OAAAC,eAAIpC,EAAAqC,UAAA,iBAAc,KAAlB,WACE,OAAOlC,KAAKa,SACRb,KAAKyE,wBACLzE,KAAK0E,0DAGX1C,OAAAC,eAAIpC,EAAAqC,UAAA,YAAS,KAAb,WACE,OAAOlC,KAAK2E,oDAGd3C,OAAAC,eAAIpC,EAAAqC,UAAA,oBAAiB,KAArB,WACE,OAAOlC,KAAKa,SACRb,KAAK4E,2BACL5E,KAAK6E,6DAGXhF,EAAAqC,UAAA4B,YAAA,SAAYgB,GACV,IAAIrF,KAAYO,KAAKC,UAIrB,GAAI,QAAS6E,EACX9E,KAAK+E,eACA,GAAI/E,KAAKsC,KAAM,CASpB,GARI,eAAgBwC,GAClB9E,KAAK2E,mBAAmBK,cAAgBhF,KAAKI,YACzCJ,KAAKK,gBACL7D,EAAAA,eAAeyI,SACnBjF,KAAKkF,oBACI,YAAaJ,GACtB9E,KAAKkF,mBAEH,SAAUJ,EAAS,CAErB,GADiBA,EAAOK,KACfC,eAAiBpF,KAAKqF,oBAC7B,OAKFrF,KAAK2E,mBAAmBW,mBAAmB,CAAE5H,WAAYsC,KAAKS,QAGhET,KAAKuF,WAIF1F,EAAAqC,UAAAsC,WAAA,WAAA,IAAAjB,EAAAvD,KACCwF,EAAgBxF,KAAK2E,mBAE3Bc,EAAAA,KACGzF,KAAKsC,KAAKoD,QACTF,EAAcG,oBAGf3I,KAAKC,EAAAA,UAAU+C,KAAKrD,WACpBO,UAAU,CACTkH,KAAM,SAACe,GACL,IAAMS,EAAWrC,EAAK3C,WAAauE,EAAKU,OAClCC,EACHX,EAAaY,YAAY,CACxB7H,MAAOqF,EAAK7C,MACZkF,SAAQA,IACPI,MAAQnG,EAAmBoG,UAC5B/H,EAAQqF,EAAK7C,MACbwF,GAAc,EAGlB,IACG3C,EAAK/C,eACL+C,EAAKxC,YACJ+E,EAAgBvC,EAAKE,mBAAmBC,cAAcyC,YACxD,CACA,IAAMC,EAAYjB,EAAaY,YAAY,CAAE7H,MAAO,EAAG0H,SAAQA,IAC/D1H,EAAQqF,EAAK8C,SAASD,EAASJ,MAAOI,EAASE,QAC/CJ,GAAe3C,EAAKhD,aAGtBiF,EAAce,UAAUrI,EAAOgI,OAKhCrG,EAAAqC,UAAAiC,MAAA,WACDnE,KAAKqE,cAAgBrE,KAAKqE,YAAYmC,WACxCxG,KAAKqE,YAAYoC,UAGfzG,KAAKsC,OACPtC,KAAKsC,KAAKmE,UACVzG,KAAKsC,KAAO,KACZtC,KAAK0G,mBAAmBC,YAAY,MACpC3G,KAAK4G,oBAAoBD,YAAY,MAErC3G,KAAKyE,wBAAwBkC,YAAY,KAAM,MAC/C3G,KAAK0E,yBAAyBiC,YAAY,KAAM,MAEhD3G,KAAK4E,2BAA2B+B,YAAY,MAC5C3G,KAAK6E,4BAA4B8B,YAAY,QAIzC9G,EAAAqC,UAAA2E,wBAAA,WACN,IAAMC,EAA4B,GAC5BC,EAAalH,EAAmBkD,cAAc/C,KAAKgB,qBAMzD,OAJI+F,IACFD,EAAqBE,mBAAqBD,GAGrCD,GAGDjH,EAAAqC,UAAA8B,qBAAA,WAAA,IAAAT,EAAAvD,KACNX,EAAOK,EAAO,oBAAqBM,KAAKI,aAExC,IAAMtD,EAAWL,EAAewK,EAAajH,KAAKrD,UAElDI,EAAAA,UAAuBD,EAAU,gBAC9BE,KAAKC,EAAAA,UAAU+C,KAAKrD,WACpBO,WAAU,SAACC,GACVoG,EAAK/B,aAAagB,KAAKrF,MAG3BJ,EAAAA,UAAuBD,EAAU,aAC9BE,KAAKC,EAAAA,UAAU+C,KAAKrD,WACpBO,WAAU,SAACC,GACVoG,EAAK9B,gBAAgBe,KAAKrF,MAG9BJ,EAAAA,UAAUD,EAAU,gBACjBE,KAAKC,EAAAA,UAAU+C,KAAKrD,WACpBO,WAAU,SAACO,OAAEC,EAAUD,EAAAC,WAClB6F,EAAKpC,mBACPoD,aAAahB,EAAKpC,mBAGpBoC,EAAKpC,kBAAoB5D,OAAOqG,YAAW,WACzCL,EAAK8B,oBAAsB3H,EAC3B6F,EAAK1B,WAAWW,KAAK9E,KACpB,QAGPX,EAAAA,UAAuBD,EAAU,qBAC9BE,KAAKC,EAAAA,UAAU+C,KAAKrD,WACpBO,WAAU,SAACC,GACVoG,EAAK7B,kBAAkBc,KAAKrF,MAGhC6C,KAAKyE,wBAA0B,IAAIwC,EAAYC,eAAclF,OAAA3C,OAAA,CAC3DvC,SAAQA,GAAKkD,KAAK6G,4BAEpB7G,KAAK4E,2BAA6B,IAAIqC,EAAYE,kBAAkB,CAClEC,YAAapH,KAAKyE,wBAClB3H,SAAQA,IAGV,IAAMuK,EAAa,CACjBvK,SAAQA,EACRkB,UAAWgC,KAAKF,QAAQ4D,cAAc4D,cAAc,OACpDC,mBAAoBvH,KAAKiB,aACzBmG,YAAapH,KAAKyE,wBAClBO,cAAehF,KAAKI,YAChBJ,KAAKK,gBACL7D,EAAAA,eAAeyI,SACnBuC,eAAgBxH,KAAK4E,4BAGvB5E,KAAK0G,mBAAqB,IAAIO,EAAYQ,UAAUJ,GACpDrH,KAAKyE,wBAAwBiD,UAAU1H,KAAK0G,oBAC5C1G,KAAK4E,2BAA2B+B,YAAY3G,KAAKsC,OAG3CzC,EAAAqC,UAAA+B,sBAAA,WAAA,IAAAV,EAAAvD,KACNX,EAAOK,EAAO,oBAAqBM,KAAKI,aAExC,IAAMtD,EAAWL,EAAewK,EAAajH,KAAKrD,UAElDI,EAAAA,UAAUD,EAAU,gBACjBE,KAAKC,EAAAA,UAAU+C,KAAKrD,WACpBO,WAAU,SAACO,OAAEC,EAAUD,EAAAC,WAClBA,IAAe6F,EAAK9C,QACtB8C,EAAK4B,KAAOzH,MAIlBX,EAAAA,UAAuBD,EAAU,gBAC9BE,KAAKC,EAAAA,UAAU+C,KAAKrD,WACpBO,WAAU,SAACC,GACVoG,EAAK/B,aAAagB,KAAKrF,MAG3BJ,EAAAA,UAAuBD,EAAU,aAC9BE,KAAKC,EAAAA,UAAU+C,KAAKrD,WACpBO,WAAU,SAACC,GACVoG,EAAK9B,gBAAgBe,KAAKrF,MAG9BJ,EAAAA,UAAuBD,EAAU,qBAC9BE,KAAKC,EAAAA,UAAU+C,KAAKrD,WACpBO,WAAU,SAACC,GACVoG,EAAK7B,kBAAkBc,KAAKrF,MAGhC6C,KAAK0E,yBAA2B,IAAIuC,EAAYC,eAAclF,OAAA3C,OAAA,CAC5DvC,SAAQA,GAAKkD,KAAK6G,4BAEpB7G,KAAK6E,4BAA8B,IAAIoC,EAAYE,kBAAkB,CACnEC,YAAapH,KAAK0E,yBAClB5H,SAAQA,IAGV,IAAMuK,EAAa,CACjBvK,SAAQA,EACRkB,UAAWgC,KAAKF,QAAQ4D,cAAc4D,cAAc,OACpDC,mBAAoBvH,KAAKiB,aACzBmG,YAAapH,KAAK0E,yBAClBM,cAAehF,KAAKI,YAChBJ,KAAKK,gBACL7D,EAAAA,eAAeyI,SACnBuC,eAAgBxH,KAAK6E,6BAGvB7E,KAAK4G,oBAAsB,IAAIK,EAAYU,oBAAoBN,GAC/DrH,KAAK0E,yBAAyBgD,UAAU1H,KAAK4G,qBAC7C5G,KAAK6E,4BAA4B8B,YAAY3G,KAAKsC,MAElDtC,KAAK4G,oBAAoBgB,mBAAqB5H,KAAKS,OAG7CZ,EAAAqC,UAAAK,mBAAA,SAAmB4C,GACzB,OAAIA,EAAO,EACF,EAGLA,EAAOnF,KAAKsC,KAAKuF,SACZ7H,KAAKsC,KAAKuF,SAGZ1C,GAGDtF,EAAAqC,UAAA4F,kBAAA,WACN,IAAMC,SAAiB/H,KAAK+D,IAE5B,IAAK/D,KAAKE,UACR,OAAOF,KAAK+D,IAGd,IAAMiE,EAAc,CAClBC,QAASjI,KAAKE,UACdgI,YAAY,GAad,MAVgB,WAAZH,EACFC,EAAOG,IAAMnI,KAAK+D,IACG,WAAZgE,SAC4BK,IAAhCpI,KAAK+D,IAAYsE,WACpBL,EAAOM,KAAOtI,KAAK+D,IAEnB/B,OAAO3C,OAAO2I,EAAQhI,KAAK+D,MAIxBiE,GAGDnI,EAAAqC,UAAA6C,QAAA,WAAA,IAAAxB,EAAAvD,KACN,GAAKA,KAAK+D,IAIV,GAAI/D,KAAKuI,aAAevI,KAAK+D,IAA7B,CAKA/D,KAAKmE,QAELnE,KAAKqE,YAAc3E,EAAM8I,YAAYxI,KAAK8H,qBAE1C9H,KAAKqE,YAAYzC,WAAa,SAAC6G,GAC7BlF,EAAK3B,WAAWY,KAAKiG,IAGvB,IAAM1E,EAAM/D,KAAK+D,IAEjB0B,EAAAA,KAAKzF,KAAKqE,YAAYqE,SACnB1L,KAAKC,EAAAA,UAAU+C,KAAKrD,WACpBO,UAAU,CACTkH,KAAM,SAACuE,GACLpF,EAAKjB,KAAOqG,EACZpF,EAAKgF,WAAaxE,EAElBR,EAAKjC,kBAAkBkB,KAAKmG,GAEvBpF,EAAKmD,qBACRnD,EAAKS,uBACLT,EAAKU,yBAGPV,EAAK2B,mBAEL3B,EAAKgC,UAEPqD,MAAO,SAACA,GACNrF,EAAK5B,QAAQa,KAAKoG,WAjCtB5I,KAAKuF,UAsCD1F,EAAAqC,UAAAqD,OAAA,WACNvF,KAAKmF,KAAOnF,KAAKS,MAEjBT,KAAK6I,UAGChJ,EAAAqC,UAAA2G,OAAA,WAAA,IAAAtF,EAAAvD,KACNA,KAAKS,MAAQT,KAAKuC,mBAAmBvC,KAAKS,OAC1C,IAAM+E,EAAgBxF,KAAK2E,mBAGN,IAAnB3E,KAAKY,WACL4E,EAAcsD,gBAAkB9I,KAAKY,WAErCgD,YAAW,WACT4B,EAAcsD,cAAgBvF,EAAK3C,aAInCZ,KAAKO,cACPqD,YAAW,WACT4B,EAAcG,kBAAoBpC,EAAK9C,SAI3CT,KAAKwE,cAGC3E,EAAAqC,UAAAmE,SAAA,SAASP,EAAuBiD,GACtC,IAAMC,EAAchJ,KAAKiB,aAAe,EAAIpB,EAAmBoJ,aAAe,EACxEC,EAAoBlJ,KAAKyD,mBAAmBC,cAAcyC,YAAc6C,EACxEG,EAAqBnJ,KAAKyD,mBAAmBC,cAAc0F,aAAeJ,EAEhF,GAA2B,IAAvBG,GAA+C,IAAnBJ,GAA8C,IAAtBG,GAA6C,IAAlBpD,EACjF,OAAO,EAGT,IAAIuD,EAAQ,EACZ,OAAQrJ,KAAKW,YACX,IAAK,WACH0I,EAAQC,KAAKC,IAAKJ,EAAqBJ,EAAkBG,EAAoBpD,GAC7E,MACF,IAAK,cACHuD,EAASF,EAAqBJ,EAC9B,MACF,IAAK,aACL,QACEM,EAASH,EAAoBpD,EAIjC,OAAQ9F,KAAKU,MAAQ2I,EAASxJ,EAAmBoG,WAG3CpG,EAAAqC,UAAAyC,iBAAA,WACN,OAAO3E,KAAKa,SAAWb,KAAK0G,mBAAqB1G,KAAK4G,qBAGhD/G,EAAAqC,UAAAgD,iBAAA,WACNlF,KAAKwJ,kBAAkB7C,YAAY3G,KAAKsC,MAEpCtC,KAAKa,UACPb,KAAK4G,oBAAoBD,YAAY,MACrC3G,KAAK0E,yBAAyBiC,YAAY,MAE1C3G,KAAK0G,mBAAmBC,YAAY3G,KAAKsC,MACzCtC,KAAKyE,wBAAwBkC,YAAY3G,KAAKsC,KAAM,QAEpDtC,KAAK0G,mBAAmBC,YAAY,MACpC3G,KAAKyE,wBAAwBkC,YAAY,MAEzC3G,KAAK4G,oBAAoBD,YAAY3G,KAAKsC,MAC1CtC,KAAK0E,yBAAyBiC,YAAY3G,KAAKsC,KAAM,aA3mBlDzC,EAAAoG,UAAY,GAAO,GACnBpG,EAAAoJ,aAAe,sBAZvBQ,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,aACVC,SAAU,q+ZAtCVC,EAAAA,0DAkDCC,EAAAA,UAASJ,KAAA,CAAC,iDAsCVK,EAAAA,OAAML,KAAA,CAAC,6CACPK,EAAAA,OAAML,KAAA,CAAC,0CACPK,EAAAA,OAAML,KAAA,CAAC,gDACPK,EAAAA,OAAML,KAAA,CAAC,wCACPK,EAAAA,OAAML,KAAA,CAAC,6BACPK,EAAAA,OAAML,KAAA,CAAC,mCACPK,EAAAA,oBACAC,EAAAA,wBAEAA,EAAAA,MAAKN,KAAA,CAAC,4BAKNM,EAAAA,MAAKN,KAAA,CAAC,4BAeNM,EAAAA,MAAKN,KAAA,CAAC,uCAKNM,EAAAA,MAAKN,KAAA,CAAC,0CAKNM,EAAAA,MAAKN,KAAA,CAAC,kCAKNM,EAAAA,MAAKN,KAAA,CAAC,iCAKNM,EAAAA,MAAKN,KAAA,CAAC,+BAKNM,EAAAA,MAAKN,KAAA,CAAC,2BAaNM,EAAAA,MAAKN,KAAA,CAAC,gCASNM,EAAAA,MAAKN,KAAA,CAAC,wCAUNM,EAAAA,MAAKN,KAAA,CAAC,4CAKNM,EAAAA,MAAKN,KAAA,CAAC,iCAKNM,EAAAA,MAAKN,KAAA,CAAC,oCAKNM,EAAAA,MAAKN,KAAA,CAAC,sCA+ENO,EAAAA,aAAYP,KAAA,CAAC,gBAAiB,aGtQjC,iCAJCQ,EAAAA,SAAQR,KAAA,CAAC,CACRS,aAAc,CAACtK,GACfuK,QAAS,CAACvK","sourcesContent":["/**\n * Created by vadimdez on 21/06/16.\n */\nimport {\n  Component,\n  Input,\n  Output,\n  ElementRef,\n  EventEmitter,\n  OnChanges,\n  SimpleChanges,\n  OnInit,\n  HostListener,\n  OnDestroy,\n  ViewChild,\n  AfterViewChecked\n} from '@angular/core';\nimport { from, fromEvent, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport * as PDFJS from 'pdfjs-dist';\nimport * as PDFJSViewer from 'pdfjs-dist/web/pdf_viewer';\n\nimport { createEventBus } from '../utils/event-bus-utils';\nimport { assign, isSSR } from '../utils/helpers';\n\nimport type {\n  PDFSource,\n  PDFPageProxy,\n  PDFProgressData,\n  PDFDocumentProxy,\n  PDFDocumentLoadingTask,\n} from './typings';\n\nif (!isSSR()) {\n  assign(PDFJS, \"verbosity\", PDFJS.VerbosityLevel.ERRORS);\n}\n\nexport enum RenderTextMode {\n  DISABLED,\n  ENABLED,\n  ENHANCED\n}\n\n@Component({\n  selector: 'pdf-viewer',\n  template: `\n    <div #pdfViewerContainer class=\"ng2-pdf-viewer-container\">\n      <div class=\"pdfViewer\"></div>\n    </div>\n  `,\n  styleUrls: ['./pdf-viewer.component.scss']\n})\nexport class PdfViewerComponent\n  implements OnChanges, OnInit, OnDestroy, AfterViewChecked {\n  static CSS_UNITS = 96.0 / 72.0;\n  static BORDER_WIDTH = 9;\n\n  @ViewChild('pdfViewerContainer') pdfViewerContainer;\n\n  private isVisible = false;\n  private pdfMultiPageViewer: any;\n  private pdfMultiPageLinkService: any;\n  private pdfMultiPageFindController: any;\n\n  private pdfSinglePageViewer: any;\n  private pdfSinglePageLinkService: any;\n  private pdfSinglePageFindController: any;\n\n  private _cMapsUrl =\n    typeof PDFJS !== 'undefined'\n      ? `https://unpkg.com/pdfjs-dist@${(PDFJS as any).version}/cmaps/`\n      : null;\n  private _renderText = true;\n  private _renderTextMode: RenderTextMode = RenderTextMode.ENABLED;\n  private _stickToPage = false;\n  private _originalSize = true;\n  private _pdf: PDFDocumentProxy;\n  private _page = 1;\n  private _zoom = 1;\n  private _zoomScale: 'page-height' | 'page-fit' | 'page-width' = 'page-width';\n  private _rotation = 0;\n  private _showAll = true;\n  private _canAutoResize = true;\n  private _fitToPage = false;\n  private _externalLinkTarget = 'blank';\n  private _showBorders = false;\n  private lastLoaded: string | Uint8Array | PDFSource;\n  private _latestScrolledPage: number;\n\n  private resizeTimeout: number | null = null;\n  private pageScrollTimeout: number | null = null;\n  private isInitialized = false;\n  private loadingTask: PDFDocumentLoadingTask;\n  private destroy$ = new Subject<void>();\n\n  @Output('after-load-complete') afterLoadComplete = new EventEmitter<PDFDocumentProxy>();\n  @Output('page-rendered') pageRendered = new EventEmitter<CustomEvent>();\n  @Output('pages-initialized') pageInitialized = new EventEmitter<CustomEvent>();\n  @Output('text-layer-rendered') textLayerRendered = new EventEmitter<CustomEvent>();\n  @Output('error') onError = new EventEmitter<any>();\n  @Output('on-progress') onProgress = new EventEmitter<PDFProgressData>();\n  @Output() pageChange: EventEmitter<number> = new EventEmitter<number>(true);\n  @Input() src: string | Uint8Array | PDFSource;\n\n  @Input('c-maps-url')\n  set cMapsUrl(cMapsUrl: string) {\n    this._cMapsUrl = cMapsUrl;\n  }\n\n  @Input('page')\n  set page(_page) {\n    _page = parseInt(_page, 10) || 1;\n    const originalPage = _page;\n\n    if (this._pdf) {\n      _page = this.getValidPageNumber(_page);\n    }\n\n    this._page = _page;\n    if (originalPage !== _page) {\n      this.pageChange.emit(_page);\n    }\n  }\n\n  @Input('render-text')\n  set renderText(renderText: boolean) {\n    this._renderText = renderText;\n  }\n\n  @Input('render-text-mode')\n  set renderTextMode(renderTextMode: RenderTextMode) {\n    this._renderTextMode = renderTextMode;\n  }\n\n  @Input('original-size')\n  set originalSize(originalSize: boolean) {\n    this._originalSize = originalSize;\n  }\n\n  @Input('show-all')\n  set showAll(value: boolean) {\n    this._showAll = value;\n  }\n\n  @Input('stick-to-page')\n  set stickToPage(value: boolean) {\n    this._stickToPage = value;\n  }\n\n  @Input('zoom')\n  set zoom(value: number) {\n    if (value <= 0) {\n      return;\n    }\n\n    this._zoom = value;\n  }\n\n  get zoom() {\n    return this._zoom;\n  }\n\n  @Input('zoom-scale')\n  set zoomScale(value: 'page-height' | 'page-fit' | 'page-width') {\n    this._zoomScale = value;\n  }\n\n  get zoomScale() {\n    return this._zoomScale;\n  }\n\n  @Input('rotation')\n  set rotation(value: number) {\n    if (!(typeof value === 'number' && value % 90 === 0)) {\n      console.warn('Invalid pages rotation angle.');\n      return;\n    }\n\n    this._rotation = value;\n  }\n\n  @Input('external-link-target')\n  set externalLinkTarget(value: string) {\n    this._externalLinkTarget = value;\n  }\n\n  @Input('autoresize')\n  set autoresize(value: boolean) {\n    this._canAutoResize = Boolean(value);\n  }\n\n  @Input('fit-to-page')\n  set fitToPage(value: boolean) {\n    this._fitToPage = Boolean(value);\n  }\n\n  @Input('show-borders')\n  set showBorders(value: boolean) {\n    this._showBorders = Boolean(value);\n  }\n\n  static getLinkTarget(type: string) {\n    switch (type) {\n      case 'blank':\n        return (PDFJS as any).LinkTarget.BLANK;\n      case 'none':\n        return (PDFJS as any).LinkTarget.NONE;\n      case 'self':\n        return (PDFJS as any).LinkTarget.SELF;\n      case 'parent':\n        return (PDFJS as any).LinkTarget.PARENT;\n      case 'top':\n        return (PDFJS as any).LinkTarget.TOP;\n    }\n\n    return null;\n  }\n\n  constructor(private element: ElementRef) {\n    if (isSSR()) {\n      return;\n    }\n\n    let pdfWorkerSrc: string;\n\n    if (\n      window.hasOwnProperty('pdfWorkerSrc') &&\n      typeof (window as any).pdfWorkerSrc === 'string' &&\n      (window as any).pdfWorkerSrc\n    ) {\n      pdfWorkerSrc = (window as any).pdfWorkerSrc;\n    } else {\n      pdfWorkerSrc = `https://cdn.jsdelivr.net/npm/pdfjs-dist@${(PDFJS as any).version\n        }/es5/build/pdf.worker.js`;\n    }\n\n    assign(PDFJS.GlobalWorkerOptions, \"workerSrc\", pdfWorkerSrc);\n  }\n\n  ngAfterViewChecked(): void {\n    if (this.isInitialized) {\n      return;\n    }\n\n    const offset = this.pdfViewerContainer.nativeElement.offsetParent;\n\n    if (this.isVisible === true && offset == null) {\n      this.isVisible = false;\n      return;\n    }\n\n    if (this.isVisible === false && offset != null) {\n      this.isVisible = true;\n\n      setTimeout(() => {\n        this.ngOnInit();\n        this.ngOnChanges({ src: this.src } as any);\n      });\n    }\n  }\n\n  ngOnInit() {\n    if (!isSSR() && this.isVisible) {\n      this.isInitialized = true;\n      this.setupMultiPageViewer();\n      this.setupSinglePageViewer();\n    }\n  }\n\n  ngOnDestroy() {\n    this.clear();\n    this.destroy$.next();\n    this.loadingTask = null;\n  }\n\n  @HostListener('window:resize', [])\n  public onPageResize() {\n    if (!this._canAutoResize || !this._pdf) {\n      return;\n    }\n\n    if (this.resizeTimeout) {\n      clearTimeout(this.resizeTimeout);\n    }\n\n    this.resizeTimeout = window.setTimeout(() => {\n      this.updateSize();\n    }, 100);\n  }\n\n  get pdfLinkService(): any {\n    return this._showAll\n      ? this.pdfMultiPageLinkService\n      : this.pdfSinglePageLinkService;\n  }\n\n  get pdfViewer(): any {\n    return this.getCurrentViewer();\n  }\n\n  get pdfFindController(): any {\n    return this._showAll\n      ? this.pdfMultiPageFindController\n      : this.pdfSinglePageFindController;\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (isSSR() || !this.isVisible) {\n      return;\n    }\n\n    if ('src' in changes) {\n      this.loadPDF();\n    } else if (this._pdf) {\n      if ('renderText' in changes) {\n        this.getCurrentViewer().textLayerMode = this._renderText\n          ? this._renderTextMode\n          : RenderTextMode.DISABLED;\n        this.resetPdfDocument();\n      } else if ('showAll' in changes) {\n        this.resetPdfDocument();\n      }\n      if ('page' in changes) {\n        const { page } = changes;\n        if (page.currentValue === this._latestScrolledPage) {\n          return;\n        }\n\n        // New form of page changing: The viewer will now jump to the specified page when it is changed.\n        // This behavior is introduced by using the PDFSinglePageViewer\n        this.getCurrentViewer().scrollPageIntoView({ pageNumber: this._page });\n      }\n\n      this.update();\n    }\n  }\n\n  public updateSize() {\n    const currentViewer = this.getCurrentViewer();\n\n    from(\n      (this._pdf.getPage(\n        currentViewer.currentPageNumber\n      ) as unknown) as Promise<PDFPageProxy>\n    )\n      .pipe(takeUntil(this.destroy$))\n      .subscribe({\n        next: (page: PDFPageProxy) => {\n          const rotation = this._rotation || page.rotate;\n          const viewportWidth =\n            (page as any).getViewport({\n              scale: this._zoom,\n              rotation\n            }).width * PdfViewerComponent.CSS_UNITS;\n          let scale = this._zoom;\n          let stickToPage = true;\n\n          // Scale the document when it shouldn't be in original size or doesn't fit into the viewport\n          if (\n            !this._originalSize ||\n            (this._fitToPage &&\n              viewportWidth > this.pdfViewerContainer.nativeElement.clientWidth)\n          ) {\n            const viewPort = (page as any).getViewport({ scale: 1, rotation });\n            scale = this.getScale(viewPort.width, viewPort.height);\n            stickToPage = !this._stickToPage;\n          }\n\n          currentViewer._setScale(scale, stickToPage);\n        }\n      });\n  }\n\n  public clear() {\n    if (this.loadingTask && !this.loadingTask.destroyed) {\n      this.loadingTask.destroy();\n    }\n\n    if (this._pdf) {\n      this._pdf.destroy();\n      this._pdf = null;\n      this.pdfMultiPageViewer.setDocument(null);\n      this.pdfSinglePageViewer.setDocument(null);\n\n      this.pdfMultiPageLinkService.setDocument(null, null);\n      this.pdfSinglePageLinkService.setDocument(null, null);\n\n      this.pdfMultiPageFindController.setDocument(null);\n      this.pdfSinglePageFindController.setDocument(null);\n    }\n  }\n\n  private getPDFLinkServiceConfig() {\n    const pdfLinkServiceConfig: any = {};\n    const linkTarget = PdfViewerComponent.getLinkTarget(this._externalLinkTarget);\n\n    if (linkTarget) {\n      pdfLinkServiceConfig.externalLinkTarget = linkTarget;\n    }\n\n    return pdfLinkServiceConfig;\n  }\n\n  private setupMultiPageViewer() {\n    assign(PDFJS, \"disableTextLayer\", !this._renderText);\n\n    const eventBus = createEventBus(PDFJSViewer, this.destroy$);\n\n    fromEvent<CustomEvent>(eventBus, 'pagerendered')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.pageRendered.emit(event);\n      });\n\n    fromEvent<CustomEvent>(eventBus, 'pagesinit')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.pageInitialized.emit(event);\n      });\n\n    fromEvent(eventBus, 'pagechanging')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe(({ pageNumber }) => {\n        if (this.pageScrollTimeout) {\n          clearTimeout(this.pageScrollTimeout);\n        }\n\n        this.pageScrollTimeout = window.setTimeout(() => {\n          this._latestScrolledPage = pageNumber;\n          this.pageChange.emit(pageNumber);\n        }, 100);\n      });\n\n    fromEvent<CustomEvent>(eventBus, 'textlayerrendered')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.textLayerRendered.emit(event);\n      });\n\n    this.pdfMultiPageLinkService = new PDFJSViewer.PDFLinkService({\n      eventBus, ...this.getPDFLinkServiceConfig()\n    });\n    this.pdfMultiPageFindController = new PDFJSViewer.PDFFindController({\n      linkService: this.pdfMultiPageLinkService,\n      eventBus\n    });\n\n    const pdfOptions = {\n      eventBus,\n      container: this.element.nativeElement.querySelector('div'),\n      removePageBorders: !this._showBorders,\n      linkService: this.pdfMultiPageLinkService,\n      textLayerMode: this._renderText\n        ? this._renderTextMode\n        : RenderTextMode.DISABLED,\n      findController: this.pdfMultiPageFindController\n    };\n\n    this.pdfMultiPageViewer = new PDFJSViewer.PDFViewer(pdfOptions);\n    this.pdfMultiPageLinkService.setViewer(this.pdfMultiPageViewer);\n    this.pdfMultiPageFindController.setDocument(this._pdf);\n  }\n\n  private setupSinglePageViewer() {\n    assign(PDFJS, \"disableTextLayer\", !this._renderText);\n\n    const eventBus = createEventBus(PDFJSViewer, this.destroy$);\n\n    fromEvent(eventBus, 'pagechanging')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe(({ pageNumber }) => {\n        if (pageNumber !== this._page) {\n          this.page = pageNumber;\n        }\n      });\n\n    fromEvent<CustomEvent>(eventBus, 'pagerendered')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.pageRendered.emit(event);\n      });\n\n    fromEvent<CustomEvent>(eventBus, 'pagesinit')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.pageInitialized.emit(event);\n      });\n\n    fromEvent<CustomEvent>(eventBus, 'textlayerrendered')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.textLayerRendered.emit(event);\n      });\n\n    this.pdfSinglePageLinkService = new PDFJSViewer.PDFLinkService({\n      eventBus, ...this.getPDFLinkServiceConfig()\n    });\n    this.pdfSinglePageFindController = new PDFJSViewer.PDFFindController({\n      linkService: this.pdfSinglePageLinkService,\n      eventBus\n    });\n\n    const pdfOptions = {\n      eventBus,\n      container: this.element.nativeElement.querySelector('div'),\n      removePageBorders: !this._showBorders,\n      linkService: this.pdfSinglePageLinkService,\n      textLayerMode: this._renderText\n        ? this._renderTextMode\n        : RenderTextMode.DISABLED,\n      findController: this.pdfSinglePageFindController\n    };\n\n    this.pdfSinglePageViewer = new PDFJSViewer.PDFSinglePageViewer(pdfOptions);\n    this.pdfSinglePageLinkService.setViewer(this.pdfSinglePageViewer);\n    this.pdfSinglePageFindController.setDocument(this._pdf);\n\n    this.pdfSinglePageViewer._currentPageNumber = this._page;\n  }\n\n  private getValidPageNumber(page: number): number {\n    if (page < 1) {\n      return 1;\n    }\n\n    if (page > this._pdf.numPages) {\n      return this._pdf.numPages;\n    }\n\n    return page;\n  }\n\n  private getDocumentParams() {\n    const srcType = typeof this.src;\n\n    if (!this._cMapsUrl) {\n      return this.src;\n    }\n\n    const params: any = {\n      cMapUrl: this._cMapsUrl,\n      cMapPacked: true\n    };\n\n    if (srcType === 'string') {\n      params.url = this.src;\n    } else if (srcType === 'object') {\n      if ((this.src as any).byteLength !== undefined) {\n        params.data = this.src;\n      } else {\n        Object.assign(params, this.src);\n      }\n    }\n\n    return params;\n  }\n\n  private loadPDF() {\n    if (!this.src) {\n      return;\n    }\n\n    if (this.lastLoaded === this.src) {\n      this.update();\n      return;\n    }\n\n    this.clear();\n\n    this.loadingTask = PDFJS.getDocument(this.getDocumentParams());\n\n    this.loadingTask.onProgress = (progressData: PDFProgressData) => {\n      this.onProgress.emit(progressData);\n    };\n\n    const src = this.src;\n\n    from(this.loadingTask.promise as Promise<PDFDocumentProxy>)\n      .pipe(takeUntil(this.destroy$))\n      .subscribe({\n        next: (pdf) => {\n          this._pdf = pdf;\n          this.lastLoaded = src;\n\n          this.afterLoadComplete.emit(pdf);\n\n          if (!this.pdfMultiPageViewer) {\n            this.setupMultiPageViewer();\n            this.setupSinglePageViewer();\n          }\n\n          this.resetPdfDocument();\n\n          this.update();\n        },\n        error: (error) => {\n          this.onError.emit(error);\n        }\n      });\n  }\n\n  private update() {\n    this.page = this._page;\n\n    this.render();\n  }\n\n  private render() {\n    this._page = this.getValidPageNumber(this._page);\n    const currentViewer = this.getCurrentViewer();\n\n    if (\n      this._rotation !== 0 ||\n      currentViewer.pagesRotation !== this._rotation\n    ) {\n      setTimeout(() => {\n        currentViewer.pagesRotation = this._rotation;\n      });\n    }\n\n    if (this._stickToPage) {\n      setTimeout(() => {\n        currentViewer.currentPageNumber = this._page;\n      });\n    }\n\n    this.updateSize();\n  }\n\n  private getScale(viewportWidth: number, viewportHeight: number) {\n    const borderSize = (this._showBorders ? 2 * PdfViewerComponent.BORDER_WIDTH : 0);\n    const pdfContainerWidth = this.pdfViewerContainer.nativeElement.clientWidth - borderSize;\n    const pdfContainerHeight = this.pdfViewerContainer.nativeElement.clientHeight - borderSize;\n\n    if (pdfContainerHeight === 0 || viewportHeight === 0 || pdfContainerWidth === 0 || viewportWidth === 0) {\n      return 1;\n    }\n\n    let ratio = 1;\n    switch (this._zoomScale) {\n      case 'page-fit':\n        ratio = Math.min((pdfContainerHeight / viewportHeight), (pdfContainerWidth / viewportWidth));\n        break;\n      case 'page-height':\n        ratio = (pdfContainerHeight / viewportHeight);\n        break;\n      case 'page-width':\n      default:\n        ratio = (pdfContainerWidth / viewportWidth);\n        break;\n    }\n\n    return (this._zoom * ratio) / PdfViewerComponent.CSS_UNITS;\n  }\n\n  private getCurrentViewer(): any {\n    return this._showAll ? this.pdfMultiPageViewer : this.pdfSinglePageViewer;\n  }\n\n  private resetPdfDocument() {\n    this.pdfFindController.setDocument(this._pdf);\n\n    if (this._showAll) {\n      this.pdfSinglePageViewer.setDocument(null);\n      this.pdfSinglePageLinkService.setDocument(null);\n\n      this.pdfMultiPageViewer.setDocument(this._pdf);\n      this.pdfMultiPageLinkService.setDocument(this._pdf, null);\n    } else {\n      this.pdfMultiPageViewer.setDocument(null);\n      this.pdfMultiPageLinkService.setDocument(null);\n\n      this.pdfSinglePageViewer.setDocument(this._pdf);\n      this.pdfSinglePageLinkService.setDocument(this._pdf, null);\n    }\n  }\n}\n","import { fromEvent, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\ninterface EventBus {\n  on(eventName: string, listener: Function): void;\n  off(eventName: string, listener: Function): void;\n}\n\nexport function createEventBus(pdfJsViewer: any, destroy$: Subject<void>) {\n  const globalEventBus: EventBus = new pdfJsViewer.EventBus();\n  attachDOMEventsToEventBus(globalEventBus, destroy$);\n  return globalEventBus;\n}\n\nfunction attachDOMEventsToEventBus(\n  eventBus: EventBus,\n  destroy$: Subject<void>\n): void {\n  fromEvent(eventBus, 'documentload')\n    .pipe(takeUntil(destroy$))\n    .subscribe(() => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('documentload', true, true, {});\n      window.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'pagerendered')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ pageNumber, cssTransform, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('pagerendered', true, true, {\n        pageNumber,\n        cssTransform,\n      });\n      source.div.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'textlayerrendered')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ pageNumber, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('textlayerrendered', true, true, { pageNumber });\n      source.textLayerDiv.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'pagechanging')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ pageNumber, source }) => {\n      const event = document.createEvent('UIEvents');\n      event.initEvent('pagechanging', true, true);\n      /* tslint:disable:no-string-literal */\n      event['pageNumber'] = pageNumber;\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'pagesinit')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('pagesinit', true, true, null);\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'pagesloaded')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ pagesCount, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('pagesloaded', true, true, { pagesCount });\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'scalechange')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ scale, presetValue, source }) => {\n      const event = document.createEvent('UIEvents');\n      event.initEvent('scalechange', true, true);\n      /* tslint:disable:no-string-literal */\n      event['scale'] = scale;\n      /* tslint:disable:no-string-literal */\n      event['presetValue'] = presetValue;\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'updateviewarea')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ location, source }) => {\n      const event = document.createEvent('UIEvents');\n      event.initEvent('updateviewarea', true, true);\n      event['location'] = location;\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'find')\n    .pipe(takeUntil(destroy$))\n    .subscribe(\n      ({\n        source,\n        type,\n        query,\n        phraseSearch,\n        caseSensitive,\n        highlightAll,\n        findPrevious,\n      }) => {\n        if (source === window) {\n          return; // event comes from FirefoxCom, no need to replicate\n        }\n        const event = document.createEvent('CustomEvent');\n        event.initCustomEvent('find' + type, true, true, {\n          query,\n          phraseSearch,\n          caseSensitive,\n          highlightAll,\n          findPrevious,\n        });\n        window.dispatchEvent(event);\n      }\n    );\n\n  fromEvent(eventBus, 'attachmentsloaded')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ attachmentsCount, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('attachmentsloaded', true, true, {\n        attachmentsCount,\n      });\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'sidebarviewchanged')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ view, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('sidebarviewchanged', true, true, { view });\n      source.outerContainer.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'pagemode')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ mode, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('pagemode', true, true, { mode });\n      source.pdfViewer.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'namedaction')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ action, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('namedaction', true, true, { action });\n      source.pdfViewer.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'presentationmodechanged')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ active, switchInProgress }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('presentationmodechanged', true, true, {\n        active,\n        switchInProgress,\n      });\n      window.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'outlineloaded')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ outlineCount, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('outlineloaded', true, true, { outlineCount });\n      source.container.dispatchEvent(event);\n    });\n}\n","export function assign(obj: Object, prop: string, value: any) {\n  obj[prop] = value;\n}\n\nexport function isSSR() {\n  return typeof window === 'undefined';\n}","/**\n * Created by vadimdez on 01/11/2016.\n */\nimport { NgModule } from '@angular/core';\n\nimport { PdfViewerComponent } from './pdf-viewer.component';\n\nexport * from './typings';\n\n@NgModule({\n  declarations: [PdfViewerComponent],\n  exports: [PdfViewerComponent]\n})\nexport class PdfViewerModule {}\n"]}